From bac199bebfe03922b15e5cdeb7dadf4b75d54b48 Mon Sep 17 00:00:00 2001
From: Raka Prasetya Pratama <madeayurenapramudya@gmail.com>
Date: Sun, 30 Apr 2023 06:42:01 +0000
Subject: [PATCH 5/5] Add ccache to envsetup.sh

---
 build/envsetup.sh | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

diff --git a/build/envsetup.sh b/build/envsetup.sh
index b4b68540..9f78861e 100644
--- a/build/envsetup.sh
+++ b/build/envsetup.sh
@@ -670,5 +670,27 @@ function fixup_common_out_dir() {
         mkdir -p ${common_out_dir}
     fi
 }
+
+# Check and set ccache path on envsetup
+if [ -z ${CCACHE_EXEC} ]; then
+	ccache_path=$(which ccache)
+	if [ ! -z "$ccache_path" ]; then
+		mkdir /mnt/ccache
+		mount --bind ~/.ccache /mnt/ccache
+		export USE_CCACHE=1
+		export CCACHE_COMPRESS=1
+		export CCACHE_EXEC=/usr/bin/ccache
+		ccache -M 50G -F 0
+		echo "yukiprjkt: ccache found on $(which ccache) "
+        echo "yukiprjkt: set CCACHE_DIR to set the ccache directory"
+        echo
+	else
+		echo "yukiprjkt: ccache not found/installed!"
+        echo "yukiprjkt: install it using: "
+        echo "yukiprjkt: Debian-based distro: sudo apt install ccache -y"
+        echo "yukiprjkt: Arch-based distro: sudo pacman -S ccache"
+	fi
+fi
+
 # Disable ABI checking
 export SKIP_ABI_CHECKS=true
-- 
2.37.3

